<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Photo Enhancer | Transform Your Images with AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
        }
        
        .glass-card {
            backdrop-filter: blur(16px) saturate(180%);
            -webkit-backdrop-filter: blur(16px) saturate(180%);
            background-color: rgba(255, 255, 255, 0.75);
            border: 1px solid rgba(255, 255, 255, 0.125);
        }
        
        .upload-area {
            transition: all 0.3s ease;
        }
        
        .upload-area.dragover {
            background-color: rgba(147, 51, 234, 0.1);
            border-color: #8b5cf6;
        }
        
        .enhance-btn {
            transition: all 0.3s ease;
            box-shadow: 0 4px 14px 0 rgba(139, 92, 246, 0.4);
        }
        
        .enhance-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px 0 rgba(139, 92, 246, 0.6);
        }
        
        .enhance-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .comparison-slider {
            position: relative;
            overflow: hidden;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .comparison-slider img {
            width: 100%;
            height: auto;
            display: block;
        }
        
        .slider-handle {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 4px;
            background: white;
            cursor: ew-resize;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
            transform: translateX(-50%);
        }
        
        .slider-handle:after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .scale-in {
            animation: scaleIn 0.5s ease-in-out;
        }
        
        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 3px solid white;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-purple-600 via-blue-600 to-indigo-800 flex items-center justify-center p-4">
    <div class="glass-card w-full max-w-4xl rounded-2xl shadow-2xl overflow-hidden fade-in">
        <!-- Header Section -->
        <div class="bg-gradient-to-r from-purple-600 to-blue-500 p-6 text-white text-center">
            <h1 class="text-3xl md:text-4xl font-bold mb-2">AI Photo Enhancer</h1>
            <p class="text-lg opacity-90">Upload your photo and let AI enhance it beautifully</p>
        </div>
        
        <!-- Main Content -->
        <div class="p-6 md:p-8">
            <!-- Upload Section -->
            <div id="uploadSection" class="mb-8">
                <div id="uploadArea" class="upload-area border-2 border-dashed border-gray-300 rounded-xl p-8 text-center cursor-pointer transition-all duration-300 hover:border-purple-400 hover:bg-purple-50">
                    <i class="fas fa-cloud-upload-alt text-4xl text-purple-500 mb-4"></i>
                    <h3 class="text-xl font-semibold text-gray-700 mb-2">Drag & Drop Your Photo</h3>
                    <p class="text-gray-500 mb-4">or click to browse files</p>
                    <p class="text-sm text-gray-400">Supports JPG, PNG, WEBP (Max 10MB)</p>
                    <input type="file" id="fileInput" class="hidden" accept="image/*">
                </div>
                
                <!-- Preview Section -->
                <div id="previewSection" class="mt-6 hidden">
                    <h3 class="text-lg font-medium text-gray-700 mb-3">Preview</h3>
                    <div class="bg-gray-100 rounded-xl p-4 flex justify-center">
                        <img id="previewImage" class="max-h-64 rounded-lg shadow-md" alt="Preview">
                    </div>
                    <div class="mt-4 flex justify-center">
                        <button id="enhanceBtn" class="enhance-btn bg-gradient-to-r from-purple-600 to-blue-500 text-white font-semibold py-3 px-8 rounded-full flex items-center">
                            <i class="fas fa-magic mr-2"></i>
                            Enhance Photo
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Loading Section -->
            <div id="loadingSection" class="hidden text-center py-12">
                <div class="spinner mx-auto mb-4"></div>
                <h3 class="text-xl font-semibold text-gray-700">Enhancing your photo with AI</h3>
                <p class="text-gray-500 mt-2">This may take a few seconds...</p>
            </div>
            
            <!-- Results Section -->
            <div id="resultsSection" class="hidden">
                <h2 class="text-2xl font-bold text-center text-gray-800 mb-6">Enhanced Result</h2>
                
                <!-- Comparison Slider -->
                <div class="comparison-slider mb-8 scale-in">
                    <div class="relative">
                        <img id="originalImage" class="block" alt="Original">
                        <div id="comparisonImageContainer" class="absolute top-0 left-0 right-0 bottom-0 overflow-hidden">
                            <img id="enhancedImage" class="block" alt="Enhanced">
                        </div>
                        <div id="sliderHandle" class="slider-handle"></div>
                    </div>
                </div>
                
                <!-- Download Button -->
                <div class="text-center">
                    <a id="downloadBtn" class="inline-flex items-center bg-gradient-to-r from-green-500 to-teal-500 text-white font-semibold py-3 px-8 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                        <i class="fas fa-download mr-2"></i>
                        Download Enhanced Image
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <div class="bg-gray-100 p-4 text-center text-gray-600 text-sm">
            <p>Powered by advanced AI technology â€¢ Secure and private</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            const previewSection = document.getElementById('previewSection');
            const previewImage = document.getElementById('previewImage');
            const enhanceBtn = document.getElementById('enhanceBtn');
            const uploadSection = document.getElementById('uploadSection');
            const loadingSection = document.getElementById('loadingSection');
            const resultsSection = document.getElementById('resultsSection');
            const originalImage = document.getElementById('originalImage');
            const enhancedImage = document.getElementById('enhancedImage');
            const comparisonImageContainer = document.getElementById('comparisonImageContainer');
            const sliderHandle = document.getElementById('sliderHandle');
            const downloadBtn = document.getElementById('downloadBtn');
            
            let originalImageUrl = '';
            let enhancedImageUrl = '';
            
            // Upload area click handler
            uploadArea.addEventListener('click', () => fileInput.click());
            
            // File input change handler
            fileInput.addEventListener('change', handleFileSelect);
            
            // Drag and drop handlers
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                
                if (e.dataTransfer.files.length) {
                    fileInput.files = e.dataTransfer.files;
                    handleFileSelect();
                }
            });
            
            // Enhance button handler
            enhanceBtn.addEventListener('click', enhancePhoto);
            
            // Handle file selection
            function handleFileSelect() {
                if (fileInput.files && fileInput.files[0]) {
                    const file = fileInput.files[0];
                    
                    // Validate file type and size
                    if (!file.type.match('image.*')) {
                        alert('Please select an image file.');
                        return;
                    }
                    
                    if (file.size > 10 * 1024 * 1024) {
                        alert('File size must be less than 10MB.');
                        return;
                    }
                    
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        originalImageUrl = e.target.result;
                        previewImage.src = originalImageUrl;
                        previewSection.classList.remove('hidden');
                        previewSection.classList.add('fade-in');
                    };
                    
                    reader.readAsDataURL(file);
                }
            }
            
            // Enhance photo function
            async function enhancePhoto() {
                // Show loading UI
                uploadSection.classList.add('hidden');
                loadingSection.classList.remove('hidden');
                enhanceBtn.disabled = true;

                const file = fileInput.files[0];
                const formData = new FormData();
                formData.append("image", file);

                try {
                    // Send image to backend
                    const res = await fetch("/enhance", { method: "POST", body: formData });
                    const data = await res.json();

                    if (data.enhancedUrl) {
                        originalImage.src = originalImageUrl;
                        enhancedImage.src = data.enhancedUrl;
                        enhancedImageUrl = data.enhancedUrl;

                        loadingSection.classList.add("hidden");
                        resultsSection.classList.remove("hidden");

                        initComparisonSlider();
                    } else {
                        alert("Error: Enhancement failed.");
                        loadingSection.classList.add("hidden");
                        uploadSection.classList.remove("hidden");
                    }
                } catch (err) {
                    alert("Server error: " + err.message);
                    loadingSection.classList.add("hidden");
                    uploadSection.classList.remove("hidden");
                } finally {
                    enhanceBtn.disabled = false;
                }
}

            
            // Initialize comparison slider
            function initComparisonSlider() {
                let isDragging = false;
                
                // Set initial position
                updateSliderPosition(50);
                
                // Mouse events
                sliderHandle.addEventListener('mousedown', startDragging);
                document.addEventListener('mousemove', drag);
                document.addEventListener('mouseup', stopDragging);
                
                // Touch events
                sliderHandle.addEventListener('touchstart', startDragging);
                document.addEventListener('touchmove', drag);
                document.addEventListener('touchend', stopDragging);
                
                function startDragging(e) {
                    e.preventDefault();
                    isDragging = true;
                }
                
                function drag(e) {
                    if (!isDragging) return;
                    
                    e.preventDefault();
                    const containerRect = comparisonImageContainer.parentElement.getBoundingClientRect();
                    let x;
                    
                    if (e.type === 'touchmove') {
                        x = e.touches[0].clientX - containerRect.left;
                    } else {
                        x = e.clientX - containerRect.left;
                    }
                    
                    // Calculate percentage
                    let percent = (x / containerRect.width) * 100;
                    
                    // Clamp between 0 and 100
                    percent = Math.max(0, Math.min(100, percent));
                    
                    updateSliderPosition(percent);
                }
                
                function stopDragging() {
                    isDragging = false;
                }
                
                function updateSliderPosition(percent) {
                    comparisonImageContainer.style.width = `${percent}%`;
                    sliderHandle.style.left = `${percent}%`;
                }
            }
            
            // Download button handler
            downloadBtn.addEventListener('click', function() {
                // In a real app, this would download the enhanced image from the backend
                // For demo, we'll create a download link for the enhanced image
                const a = document.createElement('a');
                a.href = enhancedImageUrl;
                a.download = 'enhanced-photo.jpg';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            });
        });
    </script>
</body>
</html>